<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bloodbound Arena ‚Äî Playable Fix</title>
<style>
/* ===== GLOBAL ===== */
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:radial-gradient(circle at top,#3b0000,#000 75%);
  font-family:'Trebuchet MS',Arial;
  color:#eee;
  overflow:hidden;
}

/* ===== BLOOD FX LAYER (BEHIND EVERYTHING) ===== */
#blood-drip{
  position:fixed;
  top:0;left:0;
  width:100%;
  height:140px;
  pointer-events:none;
  z-index:0;
}
.drip{
  position:absolute;
  top:-150px;
  width:18px;
  height:260px;
  background:linear-gradient(#8b0000,#300);
  border-radius:0 0 20px 20px;
  animation:drip 6s linear infinite;
}
@keyframes drip{to{transform:translateY(320px)}}

/* ===== GAME UI ===== */
#game{
  position:relative;
  z-index:10;
  width:920px;
  padding:20px;
  border-radius:18px;
  background:linear-gradient(180deg,#1a0000,#050000);
  box-shadow:0 0 60px rgba(180,0,0,.9);
}

@keyframes shake{
  0%{transform:translate(0)}
  25%{transform:translate(-6px,3px)}
  50%{transform:translate(6px,-3px)}
  75%{transform:translate(-6px,-3px)}
  100%{transform:translate(0)}
}

#arena{display:flex;justify-content:space-between}
.player{text-align:center;width:45%}
.player img{width:160px;height:160px;border-radius:12px;border:3px solid #700;object-fit:cover}

input.name{
  background:#300;
  border:none;
  color:#fff;
  text-align:center;
  font-size:18px;
}

.bar{height:12px;background:#300;border-radius:6px;overflow:hidden;margin:6px 0}
.fill{height:100%;background:linear-gradient(90deg,#ff0000,#880000)}
.fear{background:linear-gradient(90deg,#666,#aaa)}

#controls{
  margin-top:10px;
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
}
button{
  padding:10px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  background:linear-gradient(180deg,#7a0000,#3a0000);
  color:#fff;
}

#inventory{display:flex;gap:10px;margin-top:10px}
.item{padding:6px 10px;border:1px solid #700;border-radius:6px;cursor:pointer}

#log{
  margin-top:10px;
  height:140px;
  background:#050000;
  padding:10px;
  border-radius:8px;
  overflow-y:auto;
  font-size:14px;
}
</style>
</head>
<body>

<!-- BLOOD BACKGROUND -->
<div id="blood-drip"></div>

<!-- GAME -->
<div id="game">
<h2>‚ò†Ô∏è Bloodbound Arena</h2>

<div id="arena">
  <div class="player">
    <input id="playerName" class="name" value="You"><br>
    <img id="p1Img">
    <input type="file" accept="image/*" onchange="loadImage(event,'p1Img')"><br>
    <div class="bar"><div id="p1Hp" class="fill" style="width:100%"></div></div>
    <div class="bar"><div id="p1Fear" class="fill fear" style="width:0%"></div></div>
  </div>

  <div class="player">
    <input id="enemyName" class="name" value="The Butcher"><br>
    <img id="p2Img">
    <input type="file" accept="image/*" onchange="loadImage(event,'p2Img')"><br>
    <div class="bar"><div id="p2Hp" class="fill" style="width:100%"></div></div>
    <div class="bar"><div id="p2Fear" class="fill fear" style="width:0%"></div></div>
  </div>
</div>

<h4 id="turn">Your Turn</h4>

<div id="controls">
  <button onclick="attack(10)">Slash</button>
  <button onclick="attack(15)">Impale</button>
  <button onclick="attack(20)">Cleave</button>
  <button onclick="attack(30)">Execute</button>
  <button onclick="defend()">Defend</button>
  <button onclick="evade()">Evade</button>
</div>

<button onclick="restartGame()" style="margin-top:10px;width:100%">üîÑ Restart</button>

<div id="inventory">
  <div class="item" onclick="useItem('med')">üß™ Medkit</div>
  <div class="item" onclick="useItem('fear')">üíä Sedative</div>
</div>

<div id="log"></div>
</div>

<audio id="hit" src="https://cdn.pixabay.com/audio/2022/03/15/audio_5e41c4c8b0.mp3"></audio>

<script>
/* ===== BLOOD DRIPS ===== */
for(let i=0;i<18;i++){
  const d=document.createElement('div');
  d.className='drip';
  d.style.left=Math.random()*100+'%';
  d.style.animationDelay=Math.random()*5+'s';
  document.getElementById('blood-drip').appendChild(d);
}

/* ===== GAME STATE ===== */
let current=1;
let players;
const logDiv=document.getElementById('log');

function resetState(){
  players={
    1:{hp:100,fear:0,def:false,ev:false,items:{med:2,fear:1}},
    2:{hp:140,fear:0,def:false,ev:false,phase:1}
  };
}
resetState();

function loadImage(e,id){document.getElementById(id).src=URL.createObjectURL(e.target.files[0])}
function log(t){logDiv.innerHTML+=t+'<br>';logDiv.scrollTop=logDiv.scrollHeight}
function shake(){game.style.animation='shake .3s';setTimeout(()=>game.style.animation='',300)}

/* ===== PLAYER ACTIONS ===== */
function attack(d){
  if(current!==1)return;
  resolveAttack(1,2,d);
  endTurn();
}
function defend(){if(current!==1)return;players[1].def=true;log('üõ°Ô∏è You defend');endTurn()}
function evade(){if(current!==1)return;players[1].ev=true;log('üëÅÔ∏è You evade');endTurn()}

function useItem(type){
  if(current!==1)return;
  if(players[1].items[type]<=0)return;
  if(type==='med'){players[1].hp=Math.min(100,players[1].hp+30);log('üß™ Healed')}
  if(type==='fear'){players[1].fear=Math.max(0,players[1].fear-30);log('üíä Calm returns')}
  players[1].items[type]--;
  update();
  endTurn();
}

/* ===== COMBAT ===== */
function resolveAttack(a,d,damage){
  const evadeChance=.35-players[d].fear/200;
  if(players[d].ev && Math.random()<evadeChance){log('üëÅÔ∏è Attack missed');}
  else{
    const dmg=players[d].def?Math.floor(damage*.6):damage;
    players[d].hp-=dmg;
    players[d].fear+=10;
    document.getElementById('hit').play();
    shake();
    log('‚ò†Ô∏è '+dmg+' damage');
  }
  players[d].def=false;
  players[d].ev=false;
  update();
}

/* ===== AI ===== */
function aiTurn(){
  setTimeout(()=>{
    if(players[2].hp<60)players[2].phase=2;
    const r=Math.random();
    if(r<.6)resolveAttack(2,1,players[2].phase===2?30:18);
    else if(r<.8){players[2].def=true;log('Enemy defends');}
    else{players[2].ev=true;log('Enemy evades');}
    endTurn();
  },800);
}

/* ===== FLOW ===== */
function endTurn(){
  if(players[1].hp<=0||players[2].hp<=0){
    log((players[1].hp<=0?enemyName.value:playerName.value)+' wins');
    return;
  }
  current=current===1?2:1;
  document.getElementById('turn').innerText=current===1?'Your Turn':'Enemy Turn';
  if(current===2)aiTurn();
}

function update(){
  document.getElementById('p1Hp').style.width=Math.max(players[1].hp,0)+'%';
  document.getElementById('p2Hp').style.width=Math.max(players[2].hp,0)+'%';
  document.getElementById('p1Fear').style.width=players[1].fear+'%';
  document.getElementById('p2Fear').style.width=players[2].fear+'%';
}

function restartGame(){
  resetState();
  current=1;
  logDiv.innerHTML='';
  document.getElementById('turn').innerText='Your Turn';
  update();
}

update();
</script>
</body>
</html>